diff --git a/dev/airflow_perf/scheduler_dag_execution_timing.py b/dev/airflow_perf/scheduler_dag_execution_timing.py
index 47eaf92d7c..48427f35ce 100755
--- a/dev/airflow_perf/scheduler_dag_execution_timing.py
+++ b/dev/airflow_perf/scheduler_dag_execution_timing.py
@@ -27,6 +27,7 @@ from argparse import Namespace
 from operator import attrgetter

 import rich_click as click
+from sqlalchemy import delete, update

 from airflow.jobs.job import run_job
 from airflow.utils.types import DagRunTriggeredByType
@@ -135,9 +136,9 @@ def reset_dag(dag, session):
     TI = airflow.models.TaskInstance
     dag_id = dag.dag_id

-    session.query(DM).filter(DM.dag_id == dag_id).update({"is_paused": False})
-    session.query(DR).filter(DR.dag_id == dag_id).delete()
-    session.query(TI).filter(TI.dag_id == dag_id).delete()
+    session.execute(update(DM).where(DM.dag_id == dag_id).values(is_paused=False))
+    session.execute(delete(DR).where(DR.dag_id == dag_id))
+    session.execute(delete(TI).where(TI.dag_id == dag_id))


 def pause_all_dags(session):
@@ -146,7 +147,7 @@ def pause_all_dags(session):
     """
     from airflow.models.dag import DagModel

-    session.query(DagModel).update({"is_paused": True})
+    session.execute(update(DagModel).values(is_paused=True))


 def create_dag_runs(dag, num_runs, session):
